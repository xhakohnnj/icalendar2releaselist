# icalendar2releaselist

iCalendarからテンプレを作成。

最初はテンプレに張り付けるリストの作成にするつもりだったのでプロジェクト名がそんな感じに。

## 使用に関して

+ 「XBOX総合スレ 　第４避難所」での使用のみ許可します。(なんか偉そうな言い方になってもうた。)

## 機能と動作

+ Google カレンダーからテンプレを出力。
  + ネットワークを通じてGoogleカレンダーから iCalendar 形式でファイルを取得します。
  + 取得した iCalendar を解析してテンプレートに成型し、出力します。
+ iCalendarファイルからテンプレを出力
  + ローカルPC内にある iCalendar 形式のファイルからテンプレートを出力できます。

## 必要環境

+ Python 3.8.5
  + 開発時の環境になります。
  + 動作するならバージョンが違っても大丈夫だと思う。たぶん。

## 使用方法

1. PCに必要環境を導入してください。
1. GitHub の Code メニューから Download ZIP をクリックしてコード一式をダウンロードして展開してください。
1. generateTennpure.pyを実行するとテンプレートが出力されます。詳しい実行方法については後述。

## 実行方法

### Googleカレンダーから出力

**コマンド:**

``` bat
py generateTennpure.py 出力ファイル名 発売タイトルの開始日にち 発売タイトルの終了日にち ゲームパスの開始日にち ゲームパスの終了日にち イベントの開始日にち イベントの終了日にち
```

**各引数の説明:**
|名前|説明|
|---|---|
|出力ファイル名|テンプレを出力するファイル名。|
|発売タイトルの開始日にち|テンプレのリリーススケジュールに記載する期間の開始日。|
|発売タイトルの終了日にち|テンプレのリリーススケジュールに記載する期間の終了日。|
|ゲームパスの開始日にち|テンプレのゲームパスに記載する期間の開始日。|
|ゲームパスの終了日にち|テンプレのゲームパスに記載する期間の終了日。|
|イベントの開始日にち|テンプレのイベントに記載する期間の開始日。|
|イベントの終了日にち|テンプレのイベントに記載する期間の終了日。|

**例:**

``` bat
py generateTennpure.py output.txt 2023/01/29 2023/12/31 2023/02/01 2023/02/28 2023/06/01 2023/07/31
```

上記の内容では下記の内容でテンプレを出力します。

+ リリーススケジュールは*2023年1月29日*から*2023年12月31日*の期間。
+ ゲームパスは*2023年2月1日*から*2023年2月28日*の期間。
+ イベントは*2023年6月1日*から*2023年7月31日*の期間。
+ *output.txt*に出力。

### iCalendarファイルから出力

**コマンド:**

``` bat
py generateTennpureWithFile.py 出力ファイル名 発売日のiCalendarファイル名 ゲームパスINのiCalendarファイル名 ゲームパスOUTのiCalendarファイル名 イベントのiCalendarファイル名 発売タイトルの開始日にち 発売タイトルの終了日にち ゲームパスの開始日にち ゲームパスの終了日にち イベントの開始日にち イベントの終了日にち
```

**各引数の説明:**
|名前|説明|
|---|---|
|出力ファイル名|テンプレを出力するファイル名。|
|発売日のiCalendarファイル名|テンプレのリリーススケジュールに使用するiCalendarファイル名。|
|ゲームパスINのiCalendarファイル名|テンプレのゲームパスINに使用するiCalendarファイル名。|
|ゲームパスOUTのiCalendarファイル名|テンプレのゲームパスOUTに使用するiCalendarファイル名。|
|イベントのiCalendarファイル名|テンプレのイベントに使用するiCalendarファイル名。|
|発売タイトルの開始日にち|テンプレのリリーススケジュールに記載する期間の開始日。|
|発売タイトルの終了日にち|テンプレのリリーススケジュールに記載する期間の終了日。|
|ゲームパスの開始日にち|テンプレのゲームパスに記載する期間の開始日。|
|ゲームパスの終了日にち|テンプレのゲームパスに記載する期間の終了日。|
|イベントの開始日にち|テンプレのイベントに記載する期間の開始日。|
|イベントの終了日にち|テンプレのイベントに記載する期間の終了日。|

**例:**

``` bat
py generateTennpureWithFile.py output.txt release.ics gamepass_in.ics gamepass_out.ics gameevents.ics 2023/01/29 2023/12/31 2023/02/01 2023/02/28 2023/06/01 2023/07/31
```

### Googleカレンダー、iCalendarの入力について

解析する際、カレンダーの入力項目については下記のように扱っていますので、これを踏まえた入力内容でお願いします。

テンプレの各所によって違うので注意。

**リリーススケジュール、ゲームパス:**
|扱い|Googleカレンダー|iCalendar|備考|
|---|---|---|---|
|ゲームタイトル|予定のタイトル|SUMMARY||
|発売日、配信日|予定の開始日時|DTSTART|日付のみ入力してください。|

**イベント:**
|扱い|Googleカレンダー|iCalendar|備考|
|---|---|---|---|
|イベント名|予定のタイトル|SUMMARY||
|イベント開始日と日時|予定の開始日時|DTSTART|日付と時間を入力してください。|

---

以下は開発者向け。

## 開発環境

### Python 3.8.5

+ 方針として、標準ライブラリで作成する。理由は以下の通り。
  + 環境構築をシンプルにしたいため。
  + 人によっては変えたくない理由があるかもしれないので。

## その他

### iCalendarを取得するカレンダーのURL

+ 処理内にて定義。

---

## 履歴

+ 2023/05/04
  + イベントに対応。
+ 2023/02/04
  + 発売タイトルとゲームパスとで期間を別々にした。
    発売タイトルに合わせた期間にした時、まだ消えてほしくないゲームパスのタイトルが消えてしまうので。
    例えば、2月の始めに2月1日から2月末までの期間でテンプレを作った時に、1月末のゲームパスOUTは残っててほしいみたいな。
+ 2022/11/29
  + いったん完成。
